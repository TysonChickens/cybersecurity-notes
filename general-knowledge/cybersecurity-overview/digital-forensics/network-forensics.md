---
description: Focus on network traffic investigation
---

# Network Forensics

Network Forensics covers access information transmitted by listening and investigating live and recorded traffic, gathering evidence/artifacts and understanding potential problems.

The goal is to provide enough information to detect malicious activities, security breaches, policy/regulation compliance, system health and user behavior.

The investigation tries to answer the 5W:

* Who (Source IP and port)
* What (Data/payload)
* Where (Destination IP and port)
* When (Time and data)
* Why (How/What happened?)

{% hint style="info" %}
Network evidence capture and investigation process should be systematic - Having enough data and correct timeline for a successful network forensics investigation is crucial.
{% endhint %}

## Use Cases

The most common network forensics use cases:

* **Network discovery:** Discover the network to overview connected devices, rogue hosts and network load.
* **Packets reassemble:** Reassembling the packets to investigate the traffic flow. Helpful in unencrypted traffic flows.
* **Data leak detection:** Review packet transfer rates for each host and destination address.
* **Anomaly and malicious activity:** Review overall network load by focusing on used ports, source/destination addresses, helps detect possible malicious activity.
* **Policy/Regulation compliance control:** Review overall network behavior to help meet compliance.

## Advantages

* **Availability of network-based evidence:** Network traffic is collecting evidence and easier than other types of evidence such as logs and IOCs.
* **Ease of data/evidence collection without noise:** Sniffing traffic does not create much noise, logs, and alerts. Also not destructible like logs and alerts generated by security systems.
* **Availability of log sources:** Logs provide valuable information to support the investigation hypothesis if they are not destroyed.
* **Possible to gather evidence for memory and non-residential malicious activities**: Malware/threat may reside in memory to avoid detection. Sometimes, commands and connections live in the network and can be possible to detect with network forensics tools.

## Challenges

* **Decision-making:** There are several purposes of networks to SOC, IH/IR and Threat Hunting to stop anomalous activity.
* **Sufficient data/evidence collection:** There are a wide variety of data/evidence and multiple points to consider when reviewing data collection.
* **Short data capture:** Capturing all network activity is not applicable and operable.
* **Unavailability of full-packet capture on suspicious events:** Continuous capturing, storing and processing full-packets costs time and resources - Results in missing critical part of an event.
* **Encrypted traffic:** Discovering the contents of encrypted data is not possible - Can still provide valuable information such as source/destination and used services.
* **GDPR and Privacy concerns recording:** Capturing traffic is the same as "recording everything on the wire". Must comply with GDPR and business regulations (HIPAA, PCI DSS and FISMA...)
* **Nonstandard port usage:** Sometimes attackers use nonstandard ports and services to avoid detection and bypass security mechanisms.
* **Time zone issues:** Different time zones can create a challenge in event correlation for large-scale investigation.
* **Lack of logs:** Network forensics is not limited to network traffic data. Network devices and event logs are important for event correlation and investigation. Therefore, attackers/threats will often delete them to make the investigation more difficult.\


## Purposes of Network Forensics

* **Security Operations (SOC)**: Daily monitoring activities on system performance and health, user behavior, and security issues.
* **Incident Handling/Response and Threat Hunting:** During/Post-incident investigation activities to understand the reason for the incident, detect malicious/suspicious activity, and investigating the data flow content.

## Data Types

* Live traffic
* Traffic captures (full and network flows)
* Log files

{% content-ref url="../../network-security/networkminer.md" %}
[networkminer.md](../../network-security/networkminer.md)
{% endcontent-ref %}

NetworkMiner can process and handle packet picture and live traffic. The main purpose is to investigate the overall flow/condition of the limited amount of traffic, not for long and in-depth live traffic investigation.


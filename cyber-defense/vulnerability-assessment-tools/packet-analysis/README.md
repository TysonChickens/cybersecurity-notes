# Packet Analysis

{% content-ref url="wireshark-101.md" %}
[wireshark-101.md](wireshark-101.md)
{% endcontent-ref %}

Packets are the most basic unit of the network data transferred over the network. When a message is sent from one host to another, it is transmitted in small chunks with each called a packet.

Packet analysis is the process of extracting, asessing and identifying network patterns such as connections, shares, commands and other network activities, like logins, and system failutures from traffic files.

## Why Packet Analysis Matters

A Packet Capture of network events provides a rich data source for analysis.

* Capturing live data can be focused on traffic flow and statistics.
* Identifying and investigating network patterns is done at the packet level. Threat detection and real-time performance troubleshooting cannot be done without packet analysis.

## Working with PCAPs

Essential points to consider before conducting packet analysis:

| Point                                   | Details                                                                                                                                        |
| --------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------- |
| Network / Standard protocols knowledge. | Analyst must know how the protocols work and which protocol provides particular information knowing "normal" and "abnormal" behavior patterns. |
| Attack and Defense concepts.            | Understand "how attacks are conducted" to identify "what is happening" and decide "where to look".                                             |
| Practical experience in analysis tools. | Know how to use the tools to extract particular information from packet bytes.                                                                 |

A simple process checklist for packet analysis:

| Required Check    | Details                                                                                                                                                                                           |
| ----------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Hypothesis        | Know what to look for before starting an analysis.                                                                                                                                                |
| Packet Statistics | Viewing the packet statistics can show the big picture in terms of protocols, endpoints and conversations.                                                                                        |
| Known Services    | Services used in everyday operations like web browsing, file sharing and mailing. A service is a capability/application that facilitates network operations between users and applications.       |
| Unknown Services  | Unknown protocols / services are a red flags.                                                                                                                                                     |
| Known Patterns    | Understand the most common and recent case patterns to detect anomalies at first glance.                                                                                                          |
| Environment       | Adapt to the dynamics of the working environment such as IP address blocks, host name and username structure, used services, external resources, maintenance schedules, and average traffic load. |
